{"ast":null,"code":"import { fork, take, call, put, delay, takeLatest, select, takeEvery } from \"redux-saga/effects\";\nimport * as workTypes from \"../constansts/work\";\nimport * as userTypes from \"../constansts/user\";\nimport { getList, addWork, updateWork, deleteWork, updateStatus } from '../apis/work';\nimport { showLoading, hideLoading } from '../actions/loading';\n;\nimport { fetchWorksSuccess, fetchWorksFailed, addWorkSuccess, updateWorkSuccess, deleteWorkSuccess, updateStatusSuccess } from '../actions/work';\nimport { toast } from 'react-toastify';\nimport { signupSuccess, loginSuccess } from '../actions/user';\nimport { hideModal } from \"../actions/modal\";\nimport * as workApis from '../apis/work';\nimport { getUser, addUser } from '../apis/user';\n\nfunction* watchFetchListWorkAction() {\n  yield take(workTypes.FETCH_WORKS);\n  yield put(showLoading());\n  const userList = localStorage.getItem(\"user\");\n  const user = JSON.parse(userList);\n  const res = yield call(getList, user.id);\n  const {\n    status,\n    data\n  } = res;\n\n  if (status === 200) {\n    yield put(fetchWorksSuccess(data));\n    yield toast.success(\"Lấy dữ liệu thành công\");\n  } else {\n    yield put(fetchWorksFailed(err));\n    yield toast.error(\"lấy dữ liệu thất bại\");\n  }\n\n  yield delay(1000);\n  yield put(hideLoading());\n}\n\nfunction* filterWorkSaga({\n  payload\n}) {\n  const {\n    keyword\n  } = payload;\n  delay(500);\n  const listWorks = yield workApis.getList().then(res => {\n    const {\n      data\n    } = res;\n    return data;\n  });\n  const filterWorks = listWorks.filter(work => work.name_work.trim().toLowerCase().includes(keyword.trim().toLowerCase()));\n  console.log(filterWorks);\n  yield put(fetchWorksSuccess(filterWorks));\n}\n\nfunction* addWorkSaga({\n  payload\n}) {\n  const {\n    name_work,\n    description,\n    time,\n    userId,\n    status\n  } = payload.work;\n  yield put(showLoading());\n  const resp = yield call(addWork, {\n    name_work,\n    description,\n    time,\n    userId,\n    status\n  });\n  const {\n    data\n  } = resp;\n\n  if (resp.status === 201) {\n    yield put(addWorkSuccess(data));\n    yield toast.success(\"Thêm thành công\");\n  }\n\n  yield put(hideModal());\n  delay(500);\n  yield put(hideLoading());\n}\n\nfunction* updateWorkSaga({\n  payload\n}) {\n  const {\n    name_work,\n    description,\n    time,\n    userId,\n    status\n  } = payload.work;\n  const workEditing = yield select(state => state.works.workEditing);\n  yield put(showLoading());\n  const resp = yield call(updateWork, {\n    name_work,\n    description,\n    time,\n    userId,\n    status\n  }, workEditing.id);\n  const {\n    data\n  } = resp;\n\n  if (resp.status === 200) {\n    yield put(updateWorkSuccess(data));\n    yield toast.success(\"Sửa thành công\");\n  }\n\n  yield put(hideModal());\n  delay(500);\n  yield put(hideLoading());\n}\n\nfunction* deleteWorkSaga({\n  payload\n}) {\n  const {\n    id\n  } = payload;\n  yield put(showLoading());\n  const res = yield call(deleteWork, id);\n  const {\n    data\n  } = res;\n  yield put(deleteWorkSuccess(data));\n  delay(500);\n  yield put(hideLoading());\n  yield toast.success(\"Xóa thành công\");\n}\n\nfunction* updateStatusSaga({\n  payload\n}) {\n  const {\n    id,\n    status\n  } = payload;\n  yield put(showLoading());\n  const resp = yield call(updateStatus, {\n    status: !status\n  }, id);\n  const {\n    data\n  } = resp;\n\n  if (resp.status === 200) {\n    yield put(updateStatusSuccess(data));\n    yield toast.success(\"Cập nhật trạng thái thành công\");\n  }\n\n  yield put(hideModal());\n  delay(500);\n  yield put(hideLoading());\n}\n\nfunction* signupSaga({\n  payload\n}) {\n  const {\n    user\n  } = payload;\n  const {\n    name,\n    email,\n    password\n  } = user;\n  yield put(showLoading());\n  const resp = yield call(addUser, {\n    name,\n    email,\n    password\n  });\n  var {\n    data\n  } = resp;\n\n  if (resp.status === 201) {\n    yield put(signupSuccess(data));\n    yield toast.success(\"Đăng kí thành công\");\n    localStorage.setItem('user', JSON.stringify(data));\n  }\n\n  var id = data.id;\n  const res = yield call(getList, id);\n  var {\n    status,\n    data\n  } = res;\n\n  if (status === 200) {\n    yield put(fetchWorksSuccess(data));\n    yield toast.error(\"Chưa có dữ liệu công việc\");\n  } else {\n    yield put(fetchWorksFailed(err));\n    yield toast.error(\"lấy dữ liệu thất bại\");\n  }\n\n  delay(500);\n  yield put(hideLoading());\n}\n\nfunction* loginSaga({\n  payload\n}) {\n  const {\n    user\n  } = payload;\n  const {\n    email,\n    password\n  } = user;\n  yield put(showLoading());\n  const resp = yield call(getUser);\n  var {\n    data\n  } = resp;\n  const userDung = data.map(userSever => {\n    if (userSever.email === email && userSever.password === password) {\n      localStorage.setItem('user', JSON.stringify(userSever));\n      return userSever.id;\n    }\n  });\n  var id = userDung.join('');\n  yield put(loginSuccess(user));\n  const res = yield call(getList, id);\n  var {\n    status,\n    data\n  } = res;\n\n  if (status === 200) {\n    yield put(fetchWorksSuccess(data));\n    yield toast.success(\"Lấy dữ liệu thành công\");\n  } else {\n    yield put(fetchWorksFailed(err));\n    yield toast.error(\"lấy dữ liệu thất bại\");\n  }\n\n  delay(500);\n  yield put(hideLoading());\n}\n\nfunction* logoutSaga() {\n  yield put(showLoading());\n  yield localStorage.clear();\n  yield delay(1000);\n  yield put(hideLoading());\n}\n\nfunction* rootSaga() {\n  yield takeLatest(userTypes.SIGNUP, signupSaga);\n  yield takeLatest(userTypes.LOGIN, loginSaga);\n  yield takeLatest(userTypes.LOGOUT, logoutSaga);\n  const user = localStorage.getItem(\"user\");\n\n  if (user) {\n    yield fork(watchFetchListWorkAction);\n  }\n\n  yield takeLatest(workTypes.FILTER_WORKS, filterWorkSaga);\n  yield takeLatest(workTypes.ADD_WORKS, addWorkSaga);\n  yield takeLatest(workTypes.UPDATE_WORKS, updateWorkSaga);\n  yield takeLatest(workTypes.DELETE_WORKS, deleteWorkSaga);\n  yield takeLatest(workTypes.UPDATE_STATUS, updateStatusSaga);\n}\n\nexport default rootSaga;","map":{"version":3,"sources":["/home/thienncb/Desktop/redux-saga/src/sagas/index.js"],"names":["fork","take","call","put","delay","takeLatest","select","takeEvery","workTypes","userTypes","getList","addWork","updateWork","deleteWork","updateStatus","showLoading","hideLoading","fetchWorksSuccess","fetchWorksFailed","addWorkSuccess","updateWorkSuccess","deleteWorkSuccess","updateStatusSuccess","toast","signupSuccess","loginSuccess","hideModal","workApis","getUser","addUser","watchFetchListWorkAction","FETCH_WORKS","userList","localStorage","getItem","user","JSON","parse","res","id","status","data","success","err","error","filterWorkSaga","payload","keyword","listWorks","then","filterWorks","filter","work","name_work","trim","toLowerCase","includes","console","log","addWorkSaga","description","time","userId","resp","updateWorkSaga","workEditing","state","works","deleteWorkSaga","updateStatusSaga","signupSaga","name","email","password","setItem","stringify","loginSaga","userDung","map","userSever","join","logoutSaga","clear","rootSaga","SIGNUP","LOGIN","LOGOUT","FILTER_WORKS","ADD_WORKS","UPDATE_WORKS","DELETE_WORKS","UPDATE_STATUS"],"mappings":"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","sourcesContent":["import { fork, take,call,put,delay, takeLatest, select, takeEvery} from \"redux-saga/effects\";\nimport * as workTypes from \"../constansts/work\";\nimport * as userTypes from \"../constansts/user\";\nimport {getList,addWork,updateWork,deleteWork,updateStatus} from '../apis/work';\nimport {showLoading , hideLoading} from '../actions/loading';;\nimport {fetchWorksSuccess, fetchWorksFailed, addWorkSuccess, updateWorkSuccess, deleteWorkSuccess,updateStatusSuccess} from '../actions/work';\nimport { toast } from 'react-toastify';\nimport {signupSuccess,loginSuccess} from '../actions/user';\nimport { hideModal } from \"../actions/modal\";\nimport * as workApis from '../apis/work';\nimport {getUser,addUser} from '../apis/user';\nfunction* watchFetchListWorkAction() {\n    yield take(workTypes.FETCH_WORKS);\n    yield put(showLoading());\n    const userList = localStorage.getItem(\"user\");\n    const user = JSON.parse(userList);\n    const res = yield call(getList,user.id);\n    const {status, data} = res;\n    if(status === 200){\n        yield put(fetchWorksSuccess(data));\n        yield toast.success(\"Lấy dữ liệu thành công\");\n    }else{\n        yield put(fetchWorksFailed(err));\n        yield toast.error(\"lấy dữ liệu thất bại\");\n    }\n    yield delay(1000);\n    yield put(hideLoading());\n }\n function* filterWorkSaga({payload}){\n     const {keyword} = payload;\n     delay(500);\n     const listWorks = yield workApis.getList().then(res => {\n        const {data} = res;\n        return data;\n    });\n     const filterWorks = listWorks.filter(\n        work => work.name_work\n        .trim()\n        .toLowerCase()\n        .includes(keyword.trim().toLowerCase())\n\n     );\n    console.log(filterWorks);\n     yield put(fetchWorksSuccess(filterWorks));\n }\n function* addWorkSaga ({payload}){\n    const {name_work,description, time, userId,status} = payload.work;\n    yield put(showLoading());\n    const resp = yield call(addWork,{\n        name_work,\n        description,\n        time,\n        userId,\n        status\n    });\n    const {data} = resp;\n    if(resp.status === 201){\n        yield put(addWorkSuccess(data));\n        yield toast.success(\"Thêm thành công\");\n    }\n    yield put(hideModal());\n    delay(500);\n    yield put(hideLoading());\n\n }\n\n function* updateWorkSaga({payload}){\n    const {name_work,description, time, userId,status} = payload.work;\n    const workEditing = yield select(state=>state.works.workEditing);\n    yield put(showLoading());\n    const resp = yield call(updateWork,{\n        name_work,\n        description,\n        time,\n        userId,\n        status\n    },workEditing.id);\n    const {data} = resp;\n    if(resp.status === 200){\n        yield put(updateWorkSuccess(data));\n        yield toast.success(\"Sửa thành công\");\n    }\n    yield put(hideModal());\n    delay(500);\n    yield put(hideLoading());\n }\n\n function* deleteWorkSaga({payload}){\n    const {id} = payload;\n    yield put(showLoading());\n    const res = yield call(deleteWork,id);\n    const {data} = res;\n    yield put(deleteWorkSuccess(data));\n    delay(500);\n    yield put(hideLoading());\n    yield toast.success(\"Xóa thành công\");\n }\n function* updateStatusSaga({payload}){\n    const {id,status} = payload;\n    yield put(showLoading());\n    \n    const resp = yield call(updateStatus,{\n        status: !status\n    },id);\n    const {data} = resp;\n    if(resp.status === 200){\n        yield put(updateStatusSuccess(data));\n        yield toast.success(\"Cập nhật trạng thái thành công\");\n    }\n    yield put(hideModal());\n    delay(500);\n    yield put(hideLoading());\n }\n\n function* signupSaga({payload}){\n    const {user} = payload;\n    const {name,email,password} = user;\n    yield put(showLoading());\n    const resp = yield call(addUser,{\n        name,\n        email,\n        password\n    });\n    var {data} = resp;\n    if(resp.status === 201){\n        yield put(signupSuccess(data));\n        yield toast.success(\"Đăng kí thành công\");\n        localStorage.setItem('user',JSON.stringify(data));\n    }\n    var id = data.id;\n    const res = yield call(getList,id);\n    var {status, data} = res;\n    if(status === 200){\n        yield put(fetchWorksSuccess(data));\n        yield toast.error(\"Chưa có dữ liệu công việc\");\n    }else{\n        yield put(fetchWorksFailed(err));\n        yield toast.error(\"lấy dữ liệu thất bại\");\n    }\n    \n    delay(500);\n    yield put(hideLoading());\n }\n\n function* loginSaga({payload}){\n    const {user} = payload;\n    const {email,password} = user;\n    yield put(showLoading());\n    const resp = yield call(getUser);\n    var {data} = resp;\n    const userDung =  data.map(userSever=>{\n        if(userSever.email === email && userSever.password === password){\n            localStorage.setItem('user',JSON.stringify(userSever));\n            return userSever.id;\n        }  \n    });\n    var id = userDung.join('');\n    yield put(loginSuccess(user));\n    const res = yield call(getList,id);\n    var {status, data} = res;\n    if(status === 200){\n        yield put(fetchWorksSuccess(data));\n        yield toast.success(\"Lấy dữ liệu thành công\");\n    }else{\n        yield put(fetchWorksFailed(err));\n        yield toast.error(\"lấy dữ liệu thất bại\");\n    }\n    delay(500);\n    yield put(hideLoading());\n }\nfunction* logoutSaga(){\n    yield put(showLoading());\n    yield localStorage.clear();\n    yield delay(1000);\n    yield put(hideLoading());\n}\n\nfunction* rootSaga(){\n    yield takeLatest(userTypes.SIGNUP,signupSaga);\n    yield takeLatest(userTypes.LOGIN,loginSaga);\n    yield takeLatest(userTypes.LOGOUT,logoutSaga);\n    const user = localStorage.getItem(\"user\");\n    if(user){\n        yield fork(watchFetchListWorkAction);\n    }\n    \n    yield takeLatest(workTypes.FILTER_WORKS, filterWorkSaga);\n    yield takeLatest(workTypes.ADD_WORKS,addWorkSaga);\n    yield takeLatest(workTypes.UPDATE_WORKS,updateWorkSaga);\n    yield takeLatest(workTypes.DELETE_WORKS,deleteWorkSaga);\n    yield takeLatest(workTypes.UPDATE_STATUS,updateStatusSaga);\n    \n}\n\n\nexport default rootSaga;\n"]},"metadata":{},"sourceType":"module"}